<!--
* 
* @ Name    :   DRL_convertLeadAccountSection
* @ Purpose :   This is the contact section to fill details for existing ot create new contact while lead conversion
* @ Author  :   Subhodeep Sarkar
*
*   Date            |  Developer Name               |  Version      |  Changes
* ======================================================================================================
*   03-11-2022      |  Subhodeep Sarkar           |  1.0          |  Initial Version
*
-->
<aura:component controller="DRL_ConvertLeadProspectController"
                implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,forceCommunity:availableForAllPageTypes,force:lightningQuickActionWithoutHeader"
                access='global'>
    
    <aura:attribute name="str_radioButtonVal2" type="String"/>
    <aura:attribute name="obj_contact" type="Contact" default="{ 'sobjectType': 'Contact'}" />
    <aura:attribute name="str_buttonValue3" type="String" default="3" />
    <aura:attribute name="str_buttonValue4" type="String" default="4" />
    <aura:attribute name = "str_contactId" type = "String"/>
    <aura:attribute name = "existingContact" type = "String"/>
    <aura:attribute name = 'list_contactFieldSet' type = 'List' default="[]"/>
    <aura:attribute name = 'list_conFieldsToRender' type = 'List'/>
    <aura:attribute name = 'blnallowInput1' type = 'Boolean' default = 'true'/>
    <aura:attribute name = 'blnallowInput2' type = 'Boolean' default = 'false'/> 
    <aura:attribute name="blnisParentProspectConverted" type="Boolean" default="false" />  
    <aura:attribute name="blnRadio2Available" type="Boolean" default = 'true'/>
    <aura:attribute name="blnRadio1Available" type="Boolean" default = 'true'/> 
    <aura:attribute name="isRadio1Checked" type="Boolean" default = 'true'/>
    <aura:attribute name="isRadio2Checked" type="Boolean" default = 'false'/>
    
    <aura:handler name = "init" value = "{!this}" action = "{!c.doInit}"/>
    
<!--Start-->
    <div class="modal-body scrollable slds-modal__content slds-var-p-around_medium" style="background-color:#f3f2f2;">
        <div class="cCenterPanel" style="background-color:#f3f2f2;">
            <div class="header slds-theme_alt-inverse" style = "padding-left:20px">
                <p class="headerLabel">Contact</p>
            </div>
            
            <div class="slds-grid slds-gutters">
                <div  class="container  " style = "padding-left:20px">
                    <lightning:input type="radio" onchange='{!c.handleRadioChange}' label="Choose Existing"
                                     class="customRadioCls" name="options1" value="{!v.str_buttonValue4}" checked="{!v.isRadio2Checked}" disabled="{!!v.blnRadio2Available}"/>
                    <lightning:recordEditForm objectApiName="Contact">
                        <label for="nameField" class="slds-form-element__label slds-no-flex"><span
                                                                                                   style="color:#c64541;">*&nbsp;</span>Contact
                            Search</label>
                        <aura:if isTrue = '{!v.blnallowInput2}'>
                        <lightning:inputField aura:id="nameField" fieldName="ReportsToId"  class="slds-box"
                                              variant="label-hidden" disabled = 'false' value = '{!v.existingContact}'
                                              messageWhenBadInput="Please choose an existing contact or create a new one."
                                              onchange="{!c.handleLookup}" />
                            <aura:set attribute = 'else'>
                                <aura:if isTrue="{!v.blnisParentProspectConverted}">
                                    <div class="container" style = "padding-left:20px">
                                        <span class="slds-pill slds-pill_link contactPill">
                                            <span class="slds-pill__icon_container">
                                                <lightning:icon iconName="standard:contact" alternativeText="Contact" title="Contact" />
                                            </span>
                                            <a href="{!join('','/',v.obj_contact.Id)}" target="_blank" class="slds-pill__action" title="Full pill label verbiage mirrored here">
                                              <span class="slds-pill__label">{!v.obj_contact.Name}</span>
                                            </a>
                                        </span>
                                    </div>
                                    <aura:set attribute = 'else'>
                                        <lightning:inputField aura:id="nameField" fieldName="ReportsToId"  class="slds-box"
                                                    variant="label-hidden" disabled = 'true' value = '{!v.existingContact}'
                                                    messageWhenBadInput="Please choose an existing contact or create a new one."
                                                    onchange="{!c.handleLookup}" />
                                    </aura:set>
                                </aura:if>
                            
                            </aura:set>
                        </aura:if>
                    </lightning:recordEditForm>
                </div>
                <div  class="container">
                    <lightning:input type="radio" onchange="{! c.handleRadioChange }" label="Create New"
                                     class="customRadioCls" name="options1" value="{!v.str_buttonValue3}" checked="{!v.isRadio1Checked}" disabled="{!!v.blnRadio1Available}" />
                    <lightning:recordEditForm aura:id="contactForm" objectApiName="Contact">
                        <lightning:messages />
                        <div class="slds-form formContainer">
                            <div class="slds-col slds-size_1-of-1">
                                <aura:iteration items="{!v.list_conFieldsToRender}" var="field" indexVar="name">
                                    <aura:if isTrue = '{!v.blnallowInput1}'>
                                        <lightning:inputField fieldName="{!field.name}" value="{!field.value}"
                                                              required="{!field.required}" disabled= "false" class="slds-form-element"
                                                              onchange="{!c.handleValueChange}" />
                                        <aura:set attribute="else">
                                             <lightning:inputField fieldName="{!field.name}" value="{!field.value}"
                                                              required="{!field.required}" disabled= "true" class="slds-form-element"
                                                              onchange="{!c.handleValueChange}" />
                                            
                                        </aura:set>
                                    </aura:if>
                                </aura:iteration>
                                
                            </div>
                        </div>
                    </lightning:recordEditForm>
                </div>
            </div>
        </div>
    </div>
</aura:component>